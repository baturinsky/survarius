{let i=C.getContext("2d"),t,r,v,o,R=0,a=0,u,e,h,d=0,f,y,c=[],g=[],p=0,m=[1,0,0],w=[0,0,0],l=b=>Math.random()*b,M=(b,s,n)=>{i.beginPath(),i.arc(b,s,n,0,7),i.fill()};C.width=innerWidth,C.height=innerHeight,onmousemove=b=>({x:f,y}=b),setInterval(b=>{if(f==1e9)return;if(i.fillStyle=`hsl(0,9%,${p}%)`,i.fillRect(0,0,C.width,C.height),p*=.99,a++,a%120==0){let n=~~(l(3)+4),x=l(a/120);c.unshift({t:a,n,s:l(40)+40,v:l(.5)+.5,a:l(2)<1?l(80)-40:0,x:C.width,y:l(~~(C.height*.8))+.1,hp:[...Array(n)].map(W=>x)})}i.fillStyle="#0f0",M(f,y,10);let s=[[1,0,3],[7,.05,2],[32,.2,1]];for(r in m){if(w[r]+=m[r],s[r]==null)debugger;if(w[r]>s[r][0]*99){w[r]=0;let[n,x,W]=s[r];for(t=0;t<n;t++)v=t*x-x*(n-1)/2,g.unshift({g:r,x:f,y,v:Math.cos(v)*W,w:Math.sin(v)*W})}}for(h of g)h.x+=h.v,h.y+=h.w,M(h.x,h.y,5);i.fillStyle="#f00";for(e of c)if(e.hp){d=1;for(t in e.hp)if(!(e.hp[t]<=0)){d=0,u={x:e.x-e.v*(a-e.t)+t*e.s,y:e.y+Math.sin(a/100)*e.a},o=Math.sqrt(e.hp[t]+200),M(u.x,u.y,o),Math.hypot(f-u.x,y-u.y)<o+5&&(m=[1,0,0],p=99);for(let n of g)Math.hypot(n.x-u.x,n.y-u.y)<o+5&&(e.hp[t]-=10,e.g=n.g,n.x=NaN)}d&&(m[(e.g+1)%3]++,p=9,console.log(m),e.hp=null)}g.splice(1e3),c.splice(30)},1/60)}
